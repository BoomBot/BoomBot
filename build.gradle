repositories {
    mavenCentral()
    jcenter()
}

apply plugin: 'java'

def loadProperties(String sourceFileName) {
    def config = new Properties()
    def propFile = new File(sourceFileName)
    if (propFile.canRead()) {
        config.load(new FileInputStream(propFile))
        for (Map.Entry property in config) {
            ext[property.key] = property.value;
        }
    }
}

loadProperties 'build.properties'

group = "$group"
archivesBaseName = "$archiveName"
version = "$releaseVersion"

dependencies {
    compile "net.dv8tion:JDA:$jdaVersion"
    compile "com.google.code.gson:gson:$gsonVersion"
    compile "com.google.guava:guava:$guavaVersion"
    compile "commons-io:commons-io:$commonsIOVersion"
    compile "com.github.axet:vget:$vgetVersion"
}

jar {
    manifest  {
        attributes 'Main-Class' : "$mainClass"
    }
}

task fatJar(type: Jar) {
    manifest {
        attributes 'Main-Class': "$mainClass"
    }
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
    with jar
}

build.dependsOn fatJar